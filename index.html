
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>XVI EAC</title>
<meta name="theme-color" content="#000000">
<meta name="format-detection" content="telephone=no">

<!-- SF Pro Display Font -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<style>
  @font-face {
    font-family: 'SF Pro Display';
    src: local('-apple-system'), local('BlinkMacSystemFont');
    font-weight: 100 900;
  }
</style>

<!-- SortableJS -->
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js"></script>

<style>
  /* Apple Design System Variables */
  :root {
    /* Colors */
    --apple-gray-1: #f5f5f7;
    --apple-gray-2: #e8e8ed;
    --apple-gray-3: #d2d2d7;
    --apple-gray-4: #86868b;
    --apple-gray-5: #515154;
    --apple-gray-6: #1d1d1f;
    --apple-black: #000000;
    --apple-white: #ffffff;
    --apple-blue: #0071e3;
    --apple-red: #ff3b30;
    --apple-green: #30d158;
    
    /* Layout */
    --safe-area-inset-top: env(safe-area-inset-top);
    --safe-area-inset-bottom: env(safe-area-inset-bottom);
    --safe-area-inset-left: env(safe-area-inset-left);
    --safe-area-inset-right: env(safe-area-inset-right);
    
    /* Typography */
    --font: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Helvetica Neue', Helvetica, Arial, sans-serif;
    
    /* Animation */
    --ease-out-quint: cubic-bezier(0.22, 1, 0.36, 1);
    --ease-in-out-quint: cubic-bezier(0.83, 0, 0.17, 1);
    
    /* Haptic feedback timing */
    --haptic-tap: 10ms;
  }

  /* Reset */
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
  }

  /* Base */
  html {
    font-family: var(--font);
    font-size: 17px;
    line-height: 1.47059;
    font-weight: 400;
    letter-spacing: -0.022em;
    background: var(--apple-black);
    color: var(--apple-white);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    overscroll-behavior: none;
  }

  body {
    margin: 0;
    min-height: 100vh;
    min-height: -webkit-fill-available;
    overflow-x: hidden;
    position: relative;
  }

  /* Typography */
  .display {
    font-size: 32px;
    line-height: 1.125;
    font-weight: 700;
    letter-spacing: 0.004em;
  }

  .headline {
    font-size: 17px;
    line-height: 1.23536;
    font-weight: 600;
    letter-spacing: -0.022em;
  }

  .body {
    font-size: 17px;
    line-height: 1.47059;
    font-weight: 400;
    letter-spacing: -0.022em;
  }

  .caption {
    font-size: 15px;
    line-height: 1.26667;
    font-weight: 400;
    letter-spacing: -0.021em;
    color: var(--apple-gray-4);
  }

  .footnote {
    font-size: 13px;
    line-height: 1.38462;
    font-weight: 400;
    letter-spacing: -0.008em;
    color: var(--apple-gray-4);
  }

  /* Container */
  .container {
    min-height: 100vh;
    background: var(--apple-black);
    padding-top: var(--safe-area-inset-top);
    padding-bottom: calc(88px + var(--safe-area-inset-bottom));
  }

  /* Header */
  .header {
    padding: 20px;
    padding-top: max(20px, var(--safe-area-inset-top));
  }

  .header-content {
    display: flex;
    align-items: flex-start;
    gap: 16px;
  }

  .icon-container {
    width: 60px;
    height: 60px;
    background: var(--apple-gray-6);
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .icon-container svg {
    width: 32px;
    height: 32px;
    stroke: var(--apple-gray-1);
    stroke-width: 1.5;
    fill: none;
  }

  .header-text h1 {
    margin: 0;
    margin-bottom: 4px;
  }

  .tagline {
    display: inline-block;
    margin-top: 12px;
    padding: 6px 12px;
    background: var(--apple-gray-6);
    border-radius: 20px;
    font-size: 15px;
    font-weight: 500;
    color: var(--apple-gray-1);
    outline: none;
    transition: all 0.2s var(--ease-out-quint);
  }

  .tagline:focus {
    background: var(--apple-gray-5);
    transform: scale(1.02);
  }

  /* Search Bar */
  .search-section {
    padding: 0 20px 16px;
  }

  .search-bar {
    background: var(--apple-gray-6);
    border-radius: 10px;
    padding: 0 16px;
    display: flex;
    align-items: center;
    gap: 8px;
    height: 36px;
    transition: all 0.2s var(--ease-out-quint);
  }

  .search-bar:focus-within {
    background: var(--apple-gray-5);
  }

  .search-icon {
    width: 16px;
    height: 16px;
    stroke: var(--apple-gray-3);
    stroke-width: 2;
    flex-shrink: 0;
  }

  .search-input {
    flex: 1;
    background: none;
    border: none;
    outline: none;
    color: var(--apple-white);
    font-size: 17px;
    font-family: var(--font);
    letter-spacing: -0.022em;
  }

  .search-input::placeholder {
    color: var(--apple-gray-4);
  }

  /* Filter Pills */
  .filter-section {
    padding: 0 20px 20px;
    display: flex;
    gap: 8px;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }

  .filter-section::-webkit-scrollbar {
    display: none;
  }

  .pill {
    padding: 6px 16px;
    background: var(--apple-gray-6);
    border: none;
    border-radius: 20px;
    color: var(--apple-gray-1);
    font-size: 15px;
    font-weight: 500;
    font-family: var(--font);
    white-space: nowrap;
    cursor: pointer;
    transition: all 0.2s var(--ease-out-quint);
    flex-shrink: 0;
    outline: none;
    position: relative;
    overflow: hidden;
  }

  .pill:active {
    transform: scale(0.95);
  }

  .pill.active {
    background: var(--apple-gray-1);
    color: var(--apple-black);
  }

  .pill.icon-pill {
    width: 36px;
    height: 32px;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .pill svg {
    width: 18px;
    height: 18px;
    stroke: currentColor;
    stroke-width: 1.5;
    fill: none;
  }

  /* List */
  .list {
    padding: 0 20px;
  }

  .list-item {
    background: var(--apple-gray-6);
    border-radius: 12px;
    margin-bottom: 8px;
    overflow: hidden;
    transition: all 0.2s var(--ease-out-quint);
    position: relative;
  }

  .list-item:active {
    transform: scale(0.98);
    opacity: 0.7;
  }

  .list-item-content {
    padding: 16px;
    display: flex;
    align-items: center;
    gap: 12px;
    min-height: 60px;
    text-decoration: none;
    color: inherit;
    position: relative;
  }

  .drag-handle {
    width: 20px;
    height: 20px;
    position: absolute;
    left: -24px;
    opacity: 0;
    transition: all 0.3s var(--ease-out-quint);
    cursor: grab;
  }

  .reorder-mode .drag-handle {
    left: 8px;
    opacity: 0.4;
  }

  .reorder-mode .list-item-content {
    padding-left: 40px;
  }

  .list-icon {
    width: 20px;
    height: 20px;
    stroke: var(--apple-gray-3);
    stroke-width: 1.5;
    fill: none;
    flex-shrink: 0;
  }

  .list-text {
    flex: 1;
    min-width: 0;
  }

  .list-title {
    font-weight: 600;
    margin-bottom: 2px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .list-subtitle {
    color: var(--apple-gray-4);
    font-size: 15px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .list-actions {
    display: flex;
    gap: 4px;
    margin-left: auto;
    opacity: 0;
    transition: opacity 0.2s var(--ease-out-quint);
  }

  .list-item:hover .list-actions {
    opacity: 1;
  }

  .action-button {
    width: 32px;
    height: 32px;
    background: none;
    border: none;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s var(--ease-out-quint);
    outline: none;
  }

  .action-button:hover {
    background: rgba(255, 255, 255, 0.1);
  }

  .action-button:active {
    transform: scale(0.9);
  }

  .action-button svg {
    width: 18px;
    height: 18px;
    stroke: var(--apple-gray-3);
    stroke-width: 1.5;
    fill: none;
  }

  /* Floating Action Button */
  .fab {
    position: fixed;
    right: 20px;
    bottom: calc(20px + var(--safe-area-inset-bottom));
    width: 56px;
    height: 56px;
    background: var(--apple-blue);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 8px 24px rgba(0, 113, 227, 0.4);
    cursor: pointer;
    transition: all 0.2s var(--ease-out-quint);
    z-index: 100;
  }

  .fab:hover {
    transform: scale(1.05);
    box-shadow: 0 12px 32px rgba(0, 113, 227, 0.5);
  }

  .fab:active {
    transform: scale(0.95);
  }

  .fab svg {
    width: 24px;
    height: 24px;
    stroke: white;
    stroke-width: 2;
    fill: none;
  }

  /* Modal */
  .modal {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    display: flex;
    align-items: flex-end;
    justify-content: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s var(--ease-out-quint);
    z-index: 200;
    padding: 20px;
    padding-bottom: var(--safe-area-inset-bottom);
  }

  .modal.active {
    opacity: 1;
    pointer-events: auto;
  }

  .modal-content {
    width: 100%;
    max-width: 500px;
    background: var(--apple-gray-6);
    border-radius: 14px;
    transform: translateY(100%);
    transition: transform 0.4s var(--ease-out-quint);
    max-height: 90vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  .modal.active .modal-content {
    transform: translateY(0);
  }

  .modal-header {
    padding: 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .modal-title {
    font-size: 20px;
    font-weight: 600;
  }

  .modal-close {
    width: 30px;
    height: 30px;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s var(--ease-out-quint);
  }

  .modal-close:hover {
    background: rgba(255, 255, 255, 0.2);
  }

  .modal-close svg {
    width: 16px;
    height: 16px;
    stroke: var(--apple-gray-3);
    stroke-width: 2;
  }

  .modal-body {
    padding: 20px;
    overflow-y: auto;
    flex: 1;
  }

  .modal-form {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .form-label {
    font-size: 15px;
    font-weight: 500;
    color: var(--apple-gray-3);
  }

  .form-input,
  .form-select,
  .form-textarea {
    background: var(--apple-black);
    border: none;
    border-radius: 8px;
    padding: 12px 16px;
    color: var(--apple-white);
    font-size: 17px;
    font-family: var(--font);
    outline: none;
    transition: all 0.2s var(--ease-out-quint);
  }

  .form-input:focus,
  .form-select:focus,
  .form-textarea:focus {
    background: rgba(0, 0, 0, 0.8);
    box-shadow: 0 0 0 3px rgba(0, 113, 227, 0.3);
  }

  .form-textarea {
    resize: none;
    min-height: 120px;
  }

  .form-actions {
    display: flex;
    gap: 12px;
    margin-top: 8px;
  }

  .button {
    flex: 1;
    padding: 14px 20px;
    border: none;
    border-radius: 12px;
    font-size: 17px;
    font-weight: 600;
    font-family: var(--font);
    cursor: pointer;
    transition: all 0.2s var(--ease-out-quint);
    outline: none;
  }

  .button-primary {
    background: var(--apple-blue);
    color: white;
  }

  .button-primary:hover {
    background: #0077ed;
  }

  .button-primary:active {
    transform: scale(0.98);
  }

  .button-secondary {
    background: rgba(255, 255, 255, 0.1);
    color: var(--apple-gray-1);
  }

  .button-secondary:hover {
    background: rgba(255, 255, 255, 0.15);
  }

  .button-danger {
    background: var(--apple-red);
    color: white;
  }

  .button-danger:hover {
    background: #ff453a;
  }

  /* Toast */
  .toast {
    position: fixed;
    bottom: calc(100px + var(--safe-area-inset-bottom));
    left: 50%;
    transform: translateX(-50%) translateY(100px);
    background: var(--apple-gray-5);
    color: white;
    padding: 12px 20px;
    border-radius: 24px;
    font-size: 15px;
    font-weight: 500;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
    opacity: 0;
    pointer-events: none;
    transition: all 0.3s var(--ease-out-quint);
    z-index: 300;
  }

  .toast.active {
    transform: translateX(-50%) translateY(0);
    opacity: 1;
    pointer-events: auto;
  }

  .toast.success {
    background: var(--apple-green);
  }

  .toast.error {
    background: var(--apple-red);
  }

  /* Note Viewer */
  .note-viewer {
    padding: 20px;
    background: var(--apple-black);
    border-radius: 12px;
    min-height: 200px;
  }

  .note-content {
    font-size: 17px;
    line-height: 1.52941;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Animations */
  @keyframes slideUp {
    from {
      transform: translateY(100%);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  .fade-in {
    animation: fadeIn 0.3s var(--ease-out-quint);
  }

  /* Responsive */
  @media (min-width: 768px) {
    .modal {
      align-items: center;
      padding: 40px;
    }

    .modal-content {
      border-radius: 20px;
    }

    .list-actions {
      opacity: 0.3;
    }
  }

  /* Loading State */
  .loading {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 40px;
  }

  .spinner {
    width: 20px;
    height: 20px;
    border: 2px solid var(--apple-gray-5);
    border-top-color: var(--apple-gray-1);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
  }

  @keyframes spin {
    to {
      transform: rotate(360deg);
    }
  }

  /* Haptic Feedback (simulated with micro-animations) */
  .haptic {
    animation: haptic var(--haptic-tap) var(--ease-out-quint);
  }

  @keyframes haptic {
    0%, 100% {
      transform: scale(1);
    }
    50% {
      transform: scale(0.98);
    }
  }

  /* Icons */
  .icon-church {
    stroke-linecap: round;
    stroke-linejoin: round;
  }

  /* Prevent text selection except in inputs */
  input, textarea {
    -webkit-user-select: text;
    user-select: text;
  }

  /* iOS PWA Styles */
  @media (display-mode: standalone) {
    .container {
      padding-top: calc(44px + var(--safe-area-inset-top));
    }
  }


/* ==== THEME OVERRIDES (Light/Dark) ==== */

/* Always show list item actions */
.list-actions { opacity: 1 !important; }
.list-item:hover .list-actions { opacity: 1 !important; }

/* Theme icon visibility */
.theme-icon .sun { display: none; }
.theme-icon .moon { display: block; }
:root[data-theme="light"] .theme-icon .sun { display: block; }
:root[data-theme="light"] .theme-icon .moon { display: none; }

/* Apple-like Light theme palette */
:root[data-theme="light"] {
  --apple-black: #ffffff;   /* page background */
  --apple-white: #1d1d1f;   /* primary text */
  --apple-gray-6: #f5f5f7;  /* surfaces */
  --apple-gray-5: #e8e8ed;
  --apple-gray-4: #6e6e73;  /* secondary text */
  --apple-gray-3: #d2d2d7;
  --apple-gray-2: #e8e8ed;
  --apple-gray-1: #ffffff;  /* accents */
}

</style>

<style id="contrast-fixes">

/* === ChatGPT Contrast & FAB Refinements (Apple-like) === */

/* Always-visible actions (keep) */
.list-actions { opacity: 1 !important; }
.list-item:hover .list-actions { opacity: 1 !important; }

/* LIGHT THEME: stronger contrast for pills and action icons */
:root[data-theme="light"] .pill {
  background: var(--apple-gray-2) !important;  /* soft light surface */
  color: #1d1d1f !important;                   /* near-black text */
}
:root[data-theme="light"] .pill.active {
  background: var(--apple-gray-3) !important;
  color: #1d1d1f !important;
}
:root[data-theme="light"] .pill.icon-pill { color: #1d1d1f !important; }
:root[data-theme="light"] .action-button svg { stroke: #1d1d1f !important; }
:root[data-theme="light"] .action-button:hover { background: rgba(0,0,0,0.08) !important; }

/* DARK THEME: brighter action icons for proper contrast */
:root[data-theme="dark"] .action-button svg { stroke: var(--apple-gray-1) !important; }
:root[data-theme="dark"] .action-button:hover { background: rgba(255,255,255,0.12) !important; }

/* Search input in light keeps strong text contrast */
:root[data-theme="light"] .search-input { color: #1d1d1f !important; }
:root[data-theme="light"] .search-input::placeholder { color: #6e6e73 !important; }

/* Floating Action Button (“+”) – remove border look, add subtle neutral shadow */
.fab {
  border: none !important;
  box-shadow: 0 8px 16px rgba(0,0,0,0.18), 0 1px 3px rgba(0,0,0,0.12) !important;
}
.fab:hover {
  box-shadow: 0 12px 24px rgba(0,0,0,0.20), 0 2px 6px rgba(0,0,0,0.12) !important;
}

/* Ensure list item titles/labels have correct contrast in light */
:root[data-theme="light"] .list-item-title,
:root[data-theme="light"] .list-item-link,
:root[data-theme="light"] .section-title,
:root[data-theme="light"] .header-title,
:root[data-theme="light"] label {
  color: #1d1d1f !important;
}
/* Secondary text / meta in light */
:root[data-theme="light"] .meta, 
:root[data-theme="light"] .list-item-subtitle, 
:root[data-theme="light"] small {
  color: #6e6e73 !important;
}

</style>

<style id="contrast-fixes-pass2">

/* === Contrast pass 2 (targeted) === */

/* Tagline bubble text must be near-black on light */
:root[data-theme="light"] .tagline {
  color: #1d1d1f !important;
  background: var(--apple-gray-2) !important; /* subtle pill */
}

/* Search icon: ensure visible in both themes */
:root[data-theme="light"] .search-icon { stroke: #6e6e73 !important; }
:root[data-theme="dark"]  .search-icon { stroke: #ffffff !important; }

/* Action icons (copy/edit/delete) stronger in dark */
:root[data-theme="dark"] .action-button svg { stroke: #ffffff !important; }

/* Slightly stronger contrast for list item titles in dark */
:root[data-theme="dark"] .list-item-title,
:root[data-theme="dark"] .list-item-link { color: #f5f5f7 !important; }

/* Pills text/icon in dark remain readable */
:root[data-theme="dark"] .pill,
:root[data-theme="dark"] .pill svg { color: #f5f5f7 !important; stroke: #f5f5f7 !important; }

</style>

<style id='contrast-fixes-pass3'>

/* === Contrast pass 3: force action icons & search icon === */
:root[data-theme="light"] .list-actions svg { stroke: #1d1d1f !important; }
:root[data-theme="dark"]  .list-actions svg { stroke: #ffffff !important; }
:root[data-theme="dark"]  .list-icon { stroke: #d2d2d7 !important; } /* left-side link icon */

:root[data-theme="dark"]  .search-input { color: #f5f5f7 !important; }
:root[data-theme="dark"]  .search-input::placeholder { color: #a1a1a6 !important; }

</style>

<style id='contrast-fixes-pass4'>

/* === Contrast pass 4 (final targeted fixes) === */

/* 1) Search icon must never fill */
.search-icon,
.search-icon * {
  fill: none !important;
}
:root[data-theme="light"] .search-icon { stroke: #6e6e73 !important; }
:root[data-theme="dark"]  .search-icon { stroke: #ffffff !important; }

/* 2) Action icons use stroke='currentColor' inside <path>.
      Set color on the container by theme to propagate correctly. */
:root[data-theme="light"] .list-actions,
:root[data-theme="light"] .list-actions svg { color: #1d1d1f !important; }
:root[data-theme="dark"]  .list-actions,
:root[data-theme="dark"]  .list-actions svg { color: #ffffff !important; }
/* Safety: if any path/rect overrides stroke, force it to currentColor */
.list-actions path,
.list-actions rect,
.list-actions circle,
.list-actions line,
.list-actions polyline,
.list-actions polygon {
  stroke: currentColor !important;
}

/* Left-side list icon also uses currentColor; set by theme */
:root[data-theme="dark"]  .list-icon { color: #d2d2d7 !important; }
:root[data-theme="light"] .list-icon { color: #1d1d1f !important; }

/* 3) Dark theme pill.active shouldn't be white */
:root[data-theme="dark"] .pill.active {
  background: var(--apple-gray-5) !important;
  color: var(--apple-gray-1) !important;
}

</style>

<style id='modal-fixes'>

/* === Modal form clean-up (Apple) === */
/* Light theme: inputs are white with dark text; focus ring blue, sem inverter para preto */
:root[data-theme="light"] .form-input,
:root[data-theme="light"] .form-select,
:root[data-theme="light"] .form-textarea {
  background: #ffffff !important;
  color: #1d1d1f !important;
}
:root[data-theme="light"] .form-input::placeholder,
:root[data-theme="light"] .form-textarea::placeholder {
  color: #6e6e73 !important;
}
:root[data-theme="light"] .form-input:focus,
:root[data-theme="light"] .form-select:focus,
:root[data-theme="light"] .form-textarea:focus {
  background: #ffffff !important;
  box-shadow: 0 0 0 3px rgba(0,113,227,0.22) !important;
}

/* Dark theme: manter contraste suave */
:root[data-theme="dark"] .form-input,
:root[data-theme="dark"] .form-select,
:root[data-theme="dark"] .form-textarea {
  background: rgba(255,255,255,0.06) !important;  /* sutil em dark */
  color: #f5f5f7 !important;
}
:root[data-theme="dark"] .form-input:focus,
:root[data-theme="dark"] .form-select:focus,
:root[data-theme="dark"] .form-textarea:focus {
  background: rgba(255,255,255,0.10) !important;
  box-shadow: 0 0 0 3px rgba(0,113,227,0.35) !important;
}

/* Labels */
:root[data-theme="light"] .form-label { color: #6e6e73 !important; }
:root[data-theme="dark"]  .form-label { color: #d2d2d7 !important; }

/* Secondary button (Cancelar) */
:root[data-theme="light"] .button-secondary {
  background: #e8e8ed !important; /* apple-gray-2 */
  color: #1d1d1f !important;
}
:root[data-theme="light"] .button-secondary:hover {
  background: #d2d2d7 !important; /* apple-gray-3 */
}
:root[data-theme="dark"] .button-secondary {
  background: rgba(255,255,255,0.12) !important;
  color: #f5f5f7 !important;
}

/* Modal content shadow subtle + backdrop coherence */
.modal-content {
  box-shadow: 0 20px 60px rgba(0,0,0,0.25) !important;
}

</style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="icon-container">
          <svg viewBox="0 0 24 24" class="icon-church">
            <path d="M12 2v4m0 0v4m0-4h-2m2 0h2" stroke="currentColor" fill="none"/>
            <path d="M4 11h16l-3 9H7l-3-9z" stroke="currentColor" fill="none"/>
            <path d="M9 11v6m6-6v6m-3-6v9" stroke="currentColor" fill="none"/>
          </svg>
        </div>
        <div class="header-text">
          <h1 class="display">XVI EAC</h1>
          <div class="caption">Paróquia Senhor Bom Jesus</div>
          <div class="footnote">Divinópolis/MG</div>
          <div class="tagline" contenteditable="true" spellcheck="false">Estou a caminho.</div>
        </div>
      </div>
    </header>

    <!-- Search -->
    <section class="search-section">
      <div class="search-bar">
        <svg viewBox="0 0 24 24" class="search-icon">
          <circle cx="11" cy="11" r="8"/>
          <path d="m21 21-4.35-4.35"/>
        </svg>
        <input type="search" class="search-input" placeholder="Buscar" autocomplete="off" autocorrect="off">
      </div>
    </section>

    <!-- Filters -->
    <section class="filter-section">
      <button class="pill active" data-filter="all">Todos</button>
      <button class="pill" data-filter="link">Links</button>
      <button class="pill" data-filter="note">Notas</button>
      <button class="pill" data-filter="reorder">Reordenar</button>
      <button class="pill icon-pill" data-action="theme" aria-label="Alternar tema" title="Alternar tema">
  <svg viewBox="0 0 24 24" class="theme-icon" aria-hidden="true" style="width:18px;height:18px;stroke:currentColor;stroke-width:1.5;fill:none;stroke-linecap:round;stroke-linejoin:round">
    <g class="moon">
      <path d="M21 12.5A8.5 8.5 0 1 1 11.5 3a6.5 6.5 0 1 0 9.5 9.5z"/>
    </g>
    <g class="sun">
      <circle cx="12" cy="12" r="4"/>
      <path d="M12 2v2M12 20v2M2 12h2M20 12h2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M4.93 19.07l1.41-1.41M17.66 6.34l1.41-1.41"/>
    </g>
  </svg>
</button>
    </section>

    <!-- List -->
    <section class="list" id="list">
      <div class="loading">
        <div class="spinner"></div>
      </div>
    </section>
  </div>

  <!-- FAB -->
  <button class="fab" aria-label="Adicionar">
    <svg viewBox="0 0 24 24">
      <path d="M12 5v14m-7-7h14"/>
    </svg>
  </button>

  <!-- Toast -->
  <div class="toast" role="status" aria-live="polite"></div>

  <!-- Modal -->
  <div class="modal" id="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Novo Item</h2>
        <button class="modal-close" aria-label="Fechar">
          <svg viewBox="0 0 24 24">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <form class="modal-form" id="itemForm">
          <div class="form-group">
            <label class="form-label">Tipo</label>
            <select class="form-select" id="itemType">
              <option value="link">Link</option>
              <option value="note">Nota</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Título</label>
            <input type="text" class="form-input" id="itemTitle" required autocomplete="off">
          </div>
          <div class="form-group" id="urlGroup">
            <label class="form-label">URL</label>
            <input type="url" class="form-input" id="itemUrl" autocomplete="off">
          </div>
          <div class="form-group" id="noteGroup" style="display: none;">
            <label class="form-label">Conteúdo</label>
            <textarea class="form-textarea" id="itemNote"></textarea>
          </div>
          <div class="form-actions">
            <button type="button" class="button button-danger" id="deleteBtn" style="display: none;">Excluir</button>
            <button type="button" class="button button-secondary" id="cancelBtn">Cancelar</button>
            <button type="submit" class="button button-primary">Salvar</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Note Viewer Modal -->
  <div class="modal" id="noteModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="noteTitle">Nota</h2>
        <button class="modal-close" aria-label="Fechar" onclick="closeNoteModal()">
          <svg viewBox="0 0 24 24">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="note-viewer">
          <div class="note-content" id="noteContent"></div>
        </div>
        <div class="form-actions" style="margin-top: 20px;">
          <button type="button" class="button button-secondary" onclick="editNoteFromViewer()">Editar</button>
          <button type="button" class="button button-primary" onclick="closeNoteModal()">Fechar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
    import { 
      getFirestore, 
      collection, 
      doc, 
      addDoc, 
      deleteDoc, 
      updateDoc, 
      setDoc, 
      onSnapshot, 
      serverTimestamp, 
      writeBatch 
    } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyCIX7hEmpRZacxbzIxUOzKMuu4l0lXBTQQ",
      authDomain: "xvi-eac.firebaseapp.com",
      projectId: "xvi-eac",
      storageBucket: "xvi-eac.appspot.com",
      messagingSenderId: "340488873046",
      appId: "1:340488873046:web:ddc2c775fe977c4d6487f7"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Global state
    let items = [];
    let filteredItems = [];
    let currentFilter = 'all';
    let searchQuery = '';
    let isReordering = false;
    let editingItem = null;
    let sortableInstance = null;
    let viewingNoteId = null;

    // DOM elements
    const listEl = document.getElementById('list');
    const modal = document.getElementById('modal');
    const noteModal = document.getElementById('noteModal');
    const modalTitle = document.querySelector('.modal-title');
    const itemForm = document.getElementById('itemForm');
    const itemType = document.getElementById('itemType');
    const itemTitle = document.getElementById('itemTitle');
    const itemUrl = document.getElementById('itemUrl');
    const itemNote = document.getElementById('itemNote');
    const urlGroup = document.getElementById('urlGroup');
    const noteGroup = document.getElementById('noteGroup');
    const deleteBtn = document.getElementById('deleteBtn');
    const cancelBtn = document.getElementById('cancelBtn');
    const searchInput = document.querySelector('.search-input');
    const tagline = document.querySelector('.tagline');
    const fab = document.querySelector('.fab');
    const toast = document.querySelector('.toast');

    // Collections
    const itemsCol = collection(db, 'items');
    const configDoc = doc(db, 'config', 'motto');

    // Icons
    const icons = {
      link: `<svg viewBox="0 0 24 24" class="list-icon">
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" stroke="currentColor" fill="none"/>
        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" stroke="currentColor" fill="none"/>
      </svg>`,
      note: `<svg viewBox="0 0 24 24" class="list-icon">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" fill="none"/>
        <path d="M14 2v6h6" stroke="currentColor" fill="none"/>
        <path d="M16 13H8m8 4H8m2-8H8" stroke="currentColor" fill="none"/>
      </svg>`,
      copy: `<svg viewBox="0 0 24 24">
        <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none"/>
        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" stroke="currentColor" fill="none"/>
      </svg>`,
      edit: `<svg viewBox="0 0 24 24">
        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor" fill="none"/>
        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" fill="none"/>
      </svg>`,
      trash: `<svg viewBox="0 0 24 24">
        <path d="M3 6h18m-2 0v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" stroke="currentColor" fill="none"/>
      </svg>`,
      grip: `<svg viewBox="0 0 24 24" class="drag-handle">
        <circle cx="12" cy="9" r="1" fill="currentColor"/>
        <circle cx="12" cy="12" r="1" fill="currentColor"/>
        <circle cx="12" cy="15" r="1" fill="currentColor"/>
        <circle cx="9" cy="9" r="1" fill="currentColor"/>
        <circle cx="9" cy="12" r="1" fill="currentColor"/>
        <circle cx="9" cy="15" r="1" fill="currentColor"/>
      </svg>`
    };

    // Utility functions
    function showToast(message, type = '') {
      toast.textContent = message;
      toast.className = `toast active ${type}`;
      setTimeout(() => {
        toast.classList.remove('active');
      }, 3000);
    }

    function openModal() {
      modal.classList.add('active');
      document.body.style.overflow = 'hidden';
      setTimeout(() => itemTitle.focus(), 300);
    }

    function closeModal() {
      modal.classList.remove('active');
      document.body.style.overflow = '';
      resetForm();
    }

    function openNoteModal(id, data) {
      viewingNoteId = id;
      document.getElementById('noteTitle').textContent = data.title || 'Nota';
      document.getElementById('noteContent').textContent = data.note || '';
      noteModal.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    window.closeNoteModal = function() {
      noteModal.classList.remove('active');
      document.body.style.overflow = '';
      viewingNoteId = null;
    }

    window.editNoteFromViewer = function() {
      const item = items.find(i => i.id === viewingNoteId);
      if (item) {
        closeNoteModal();
        openEditModal(item.id, item.data);
      }
    }

    function resetForm() {
      itemForm.reset();
      editingItem = null;
      modalTitle.textContent = 'Novo Item';
      deleteBtn.style.display = 'none';
      itemType.value = 'link';
      updateFormFields();
    }

    function updateFormFields() {
      const type = itemType.value;
      if (type === 'link') {
        urlGroup.style.display = 'block';
        noteGroup.style.display = 'none';
      } else {
        urlGroup.style.display = 'none';
        noteGroup.style.display = 'block';
      }
    }

    function openEditModal(id, data) {
      editingItem = { id, data };
      modalTitle.textContent = 'Editar Item';
      itemType.value = data.type || 'link';
      itemTitle.value = data.title || '';
      itemUrl.value = data.url || '';
      itemNote.value = data.note || '';
      deleteBtn.style.display = 'block';
      updateFormFields();
      openModal();
    }

    // Filter functionality
    function filterItems() {
      filteredItems = items.filter(item => {
        const matchesType = currentFilter === 'all' || item.data.type === currentFilter;
        const matchesSearch = !searchQuery || 
          (item.data.title && item.data.title.toLowerCase().includes(searchQuery.toLowerCase())) ||
          (item.data.note && item.data.note.toLowerCase().includes(searchQuery.toLowerCase()));
        return matchesType && matchesSearch;
      });
      renderList();
    }

    // Render list
    function renderList() {
      if (filteredItems.length === 0) {
        listEl.innerHTML = `
          <div style="text-align: center; padding: 60px 20px; color: var(--apple-gray-4);">
            <div class="footnote">Nenhum item encontrado</div>
          </div>
        `;
        return;
      }

      const sortedItems = [...filteredItems].sort((a, b) => {
        const posA = a.data.position ?? 999999;
        const posB = b.data.position ?? 999999;
        return posA - posB;
      });

      listEl.innerHTML = sortedItems.map(({ id, data }) => {
        const isLink = data.type === 'link';
        return `
          <div class="list-item ${isReordering ? 'reorder-mode' : ''}" data-id="${id}">
            ${isLink ? `<a href="${data.url}" target="_blank" rel="noopener" class="list-item-content">` : `<div class="list-item-content" onclick="window.openNote('${id}')">` }
              ${icons.grip}
              ${icons[data.type] || icons.link}
              <div class="list-text">
                <div class="list-title">${data.title || 'Sem título'}</div>
                ${data.type === 'note' && data.note ? `<div class="list-subtitle">${data.note.substring(0, 60)}${data.note.length > 60 ? '...' : ''}</div>` : ''}
              </div>
              <div class="list-actions">
                ${isLink ? `
                  <button class="action-button" onclick="window.copyLink(event, '${data.url}')" title="Copiar">
                    ${icons.copy}
                  </button>
                ` : ''}
                <button class="action-button" onclick="window.editItem(event, '${id}')" title="Editar">
                  ${icons.edit}
                </button>
                <button class="action-button" onclick="window.deleteItem(event, '${id}')" title="Excluir">
                  ${icons.trash}
                </button>
              </div>
            ${isLink ? '</a>' : '</div>'}
          </div>
        `;
      }).join('');

      // Setup sortable if in reorder mode
      if (isReordering) {
        if (sortableInstance) sortableInstance.destroy();
        sortableInstance = new Sortable(listEl, {
          animation: 150,
          handle: '.drag-handle',
          onEnd: updateOrder
        });
      }
    }

    // Window functions for event handlers
    window.openNote = function(id) {
      const item = items.find(i => i.id === id);
      if (item && item.data.type === 'note') {
        openNoteModal(id, item.data);
      }
    }

    window.copyLink = async function(event, url) {
      event.preventDefault();
      event.stopPropagation();
      try {
        await navigator.clipboard.writeText(url);
        showToast('Link copiado', 'success');
      } catch (err) {
        showToast('Erro ao copiar', 'error');
      }
    }

    window.editItem = function(event, id) {
      event.preventDefault();
      event.stopPropagation();
      const item = items.find(i => i.id === id);
      if (item) {
        openEditModal(id, item.data);
      }
    }

    window.deleteItem = async function(event, id) {
      event.preventDefault();
      event.stopPropagation();
      if (confirm('Excluir este item?')) {
        try {
          await deleteDoc(doc(itemsCol, id));
          showToast('Item excluído', 'success');
        } catch (err) {
          showToast('Erro ao excluir', 'error');
        }
      }
    }

    // Update order in Firestore
    async function updateOrder() {
      const orderedIds = Array.from(listEl.querySelectorAll('.list-item')).map(el => el.dataset.id);
      const batch = writeBatch(db);
      
      orderedIds.forEach((id, index) => {
        batch.update(doc(itemsCol, id), { position: index });
      });

      try {
        await batch.commit();
        showToast('Ordem atualizada', 'success');
      } catch (err) {
        showToast('Erro ao atualizar ordem', 'error');
      }
    }

    // Event listeners
    fab.addEventListener('click', () => {
      resetForm();
      openModal();
    });

    document.querySelector('.modal-close').addEventListener('click', closeModal);
    cancelBtn.addEventListener('click', closeModal);

    modal.addEventListener('click', (e) => {
      if (e.target === modal) closeModal();
    });

    noteModal.addEventListener('click', (e) => {
      if (e.target === noteModal) closeNoteModal();
    });

    itemType.addEventListener('change', updateFormFields);

    searchInput.addEventListener('input', (e) => {
      searchQuery = e.target.value;
      filterItems();
    });

    // Filter pills
    document.querySelectorAll('.pill[data-filter]').forEach(pill => {
      pill.addEventListener('click', () => {
        const filter = pill.dataset.filter;
        
        if (filter === 'reorder') {
          if (currentFilter !== 'all' || searchQuery) {
            showToast('Limpe a busca e selecione "Todos" para reordenar');
            return;
          }
          isReordering = !isReordering;
          pill.classList.toggle('active', isReordering);
          renderList();
        } else {
          currentFilter = filter;
          document.querySelectorAll('.pill[data-filter]').forEach(p => {
            if (p.dataset.filter !== 'reorder') {
              p.classList.toggle('active', p.dataset.filter === filter);
            }
          });
          filterItems();
        }
      });
    });

    // ===== THEME MANAGEMENT =====
const themeBtn = document.querySelector('.pill[data-action="theme"]');
const metaTheme = document.querySelector('meta[name="theme-color"]');
const metaStatusBar = document.querySelector('meta[name="apple-mobile-web-app-status-bar-style"]');

function applyTheme(mode) {
  document.documentElement.setAttribute('data-theme', mode);
  try { localStorage.setItem('theme', mode); } catch (e) {}

  if (metaTheme) metaTheme.setAttribute('content', mode === 'light' ? '#ffffff' : '#000000');
  if (metaStatusBar) metaStatusBar.setAttribute('content', mode === 'light' ? 'default' : 'black-translucent');
}

function getPreferredTheme() {
  try {
    const saved = localStorage.getItem('theme');
    if (saved === 'light' || saved === 'dark') return saved;
  } catch (e) {}
  return (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) ? 'light' : 'dark';
}

// Initialize theme on load
applyTheme(getPreferredTheme());

// Toggle on click
themeBtn.addEventListener('click', () => {
  const current = document.documentElement.getAttribute('data-theme') === 'light' ? 'light' : 'dark';
  const next = current === 'light' ? 'dark' : 'light';
  applyTheme(next);
  showToast(next === 'light' ? 'Tema: Claro' : 'Tema: Escuro');
});

// Form submission
    itemForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const data = {
        type: itemType.value,
        title: itemTitle.value.trim(),
        url: itemType.value === 'link' ? itemUrl.value.trim() : '',
        note: itemType.value === 'note' ? itemNote.value.trim() : '',
        updatedAt: serverTimestamp()
      };

      if (!data.title) {
        showToast('Digite um título', 'error');
        return;
      }

      if (data.type === 'link' && !data.url) {
        showToast('Digite uma URL', 'error');
        return;
      }

      try {
        if (editingItem) {
          await updateDoc(doc(itemsCol, editingItem.id), data);
          showToast('Item atualizado', 'success');
        } else {
          data.createdAt = serverTimestamp();
          data.position = items.length;
          await addDoc(itemsCol, data);
          showToast('Item adicionado', 'success');
        }
        closeModal();
      } catch (err) {
        showToast('Erro ao salvar', 'error');
      }
    });

    // Delete button
    deleteBtn.addEventListener('click', async () => {
      if (editingItem && confirm('Excluir este item?')) {
        try {
          await deleteDoc(doc(itemsCol, editingItem.id));
          showToast('Item excluído', 'success');
          closeModal();
        } catch (err) {
          showToast('Erro ao excluir', 'error');
        }
      }
    });

    // Tagline editing
    tagline.addEventListener('blur', async () => {
      const text = tagline.textContent.trim();
      try {
        await setDoc(configDoc, { text });
        showToast('Frase atualizada', 'success');
      } catch (err) {
        showToast('Erro ao salvar frase', 'error');
      }
    });

    tagline.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        e.preventDefault();
        tagline.blur();
      }
    });

    // Firebase listeners
    onSnapshot(configDoc, (snapshot) => {
      const data = snapshot.data();
      if (data && data.text) {
        tagline.textContent = data.text;
      }
    });

    onSnapshot(itemsCol, (snapshot) => {
      items = snapshot.docs.map(doc => ({
        id: doc.id,
        data: doc.data()
      }));
      filterItems();
    });

    // Initial setup
    updateFormFields();
  </script>
</body>
</html>
